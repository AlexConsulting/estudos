<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>7 Dias para Encontrar Sua Identidade em Cristo (G√°latas)</title>
<style>
        /* 0. Vari√°vel CSS para controle de Zoom/Fonte (Acessibilidade) */
        :root {
            --base-font-scale: 1.0; /* Valor padr√£o para 100% */
        }
        
        /* 1. CSS PRINCIPAL (LIGHT THEME - PADR√ÉO) */
        body {
            font-family: 'Georgia', serif;
            margin: 0; background-color: #e6e0d3; color: #333; line-height: 1.6;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            min-height: 100vh; 
            /* AJUSTE 1: Remove o espa√ßamento superior global, mantendo o de baixo se o conte√∫do for curto */
            padding: 0 0 20px 0; 
            transition: background-color 0.3s, color 0.3s;
        }
        .book-container {
            max-width: 650px; width: 90%; background: #fdfdfd; padding: 30px 40px;
            border-radius: 8px; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2); border: 1px solid #ccc;
            position: relative; transition: background 0.3s, box-shadow 0.3s;
            font-size: calc(var(--base-font-scale) * 1em); 
        }
        h1 {
            color: #4b0082; text-align: center; font-family: 'Times New Roman', serif;
            border-bottom: 2px solid #4b0082; padding-bottom: 10px; margin-bottom: 10px;
        }
        .subtitle {
            text-align: center; font-style: italic; margin-bottom: 20px; color: #555; font-size: 0.95em;
        }
        h2 {
            color: #007bff; font-size: 1.5em; text-align: center; margin-top: 10px; margin-bottom: 20px;
        }
        .versiculos {
            font-style: italic; background-color: #f0f8ff; padding: 15px;
            border-left: 5px solid #28a745; margin: 15px 0; font-weight: 500;
        }
        .section {
            margin-top: 20px; padding: 10px; border-bottom: 1px dashed #ddd;
        }
        .section strong {
            display: block; color: #dc3545; margin-bottom: 5px; font-weight: bold;
        }
        .oracao-final {
            margin-top: 25px; padding: 15px; background-color: #fffae0;
            border-left: 5px solid #ffc107; font-weight: bold; text-align: center; font-style: italic;
        }
        
        /* 2. NAVEGA√á√ÉO E UTILS */
        .top-utils {
            display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap: 15px; 
        }
        .navigation {
            display: flex; justify-content: space-between; align-items: center; margin-top: 30px;
            padding-top: 15px; border-top: 1px solid #ddd; flex-wrap: wrap; gap: 15px; 
        }
        .nav-button {
            padding: 10px 15px; cursor: pointer; border: 1px solid #007bff; border-radius: 5px;
            background-color: #007bff; color: white; transition: opacity 0.2s, background 0.2s, border-color 0.2s;
        }
        .nav-button:disabled { opacity: 0.5; cursor: default; }
        button:focus, a:focus, input:focus, #accessibilityFloater button:focus {
            outline: 3px solid #00ff73; outline-offset: 2px; box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.5);
        }

        /* 3. DARK THEME CSS (Mantido) */
        .dark-theme { background-color: #121212; color: #f4f4f4; }
        .dark-theme .book-container { background: #1e1e1e; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5); border-color: #333; }
        .dark-theme h1 { color: #bb86fc; border-bottom-color: #bb86fc; }
        .dark-theme .subtitle { color: #aaa; }
        .dark-theme h2 { color: #03dac6; }
        .dark-theme .versiculos { background-color: #2c2c2c; border-left-color: #03dac6; }
        .dark-theme .section { border-bottom-color: #444; }
        .dark-theme .section strong { color: #cf6679; }
        .dark-theme .oracao-final { background-color: #33331c; border-left-color: #ffd600; }
        .dark-theme .nav-button { background-color: #03dac6; border-color: #03dac6; color: #1e1e1e; }
        
        /* 4. SELETOR DE IDIOMA, LEITURA E TEMA */
        /* CORRE√á√ÉO CR√çTICA: Oculta bot√µes de Idioma e Tema em TODAS as resolu√ß√µes (Desktop e Mobile) */
        .language-selector-wrapper, #themeToggle {
            display: none !important;
        }
        
        .language-selector-wrapper { position: relative; display: inline-block; z-index: 10; }
        #langSelectButton, #themeToggle, #listenToggle { 
            background-color: #f0f0f0; border: 1px solid #ccc; color: #333; border-radius: 5px;
            padding: 8px 12px; cursor: pointer; display: flex; align-items: center;
            font-size: 0.9em; font-weight: bold; transition: background-color 0.2s, border-color 0.2s, color 0.2s;
        }
        #listenToggle[disabled] { opacity: 0.6; cursor: wait; }
        #langSelectButton:hover, #themeToggle:hover, #listenToggle:hover:not([disabled]) { background-color: #e0e0e0; }
        /* (Estilos de Dropdown e Dark Theme para utilit√°rios mantidos) */
        .lang-flag-active { width: 24px; height: 18px; margin-right: 8px; border: 1px solid #ddd; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); }
        #langDropdown { display: none; position: absolute; top: 100%; left: 0; min-width: 150px; background-color: white; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); border: 1px solid #ddd; border-radius: 5px; margin-top: 5px; overflow: hidden; }
        #langDropdown a { color: #333; padding: 10px 15px; text-decoration: none; display: flex; align-items: center; font-size: 0.9em; }
        #langDropdown a:hover { background-color: #f5f5f5; }
        .lang-flag-dropdown { width: 20px; height: 15px; margin-right: 10px; border: 1px solid #eee; }
        .dark-theme #langSelectButton, .dark-theme #themeToggle, .dark-theme #listenToggle { background-color: #2c2c2c; border-color: #444; color: #f4f4f4; }
        .dark-theme #langSelectButton:hover, .dark-theme #themeToggle:hover, .dark-theme #listenToggle:hover:not([disabled]) { background-color: #333; }
        .dark-theme #langDropdown { background-color: #1e1e1e; border-color: #444; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); }
        .dark-theme #langDropdown a { color: #f4f4f4; }
        .dark-theme #langDropdown a:hover { background-color: #333; }
        
        /* 5. Menu de Acessibilidade Flutuante (Desktop e Mobile) */
        /* AJUSTE 2: Fixa A+A- no canto superior direito */
        #accessibilityFloater {
            position: fixed; 
            right: 20px; 
            top: 20px; 
            transform: translateY(0); /* Garante que n√£o use a centraliza√ß√£o vertical */
            display: flex; flex-direction: column; z-index: 1000;
            padding: 8px 5px; background: rgba(255, 255, 255, 0.8); border: 1px solid #ccc;
            border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        #accessibilityFloater button {
            padding: 5px 8px; margin: 5px 0; cursor: pointer; border: 1px solid #007bff;
            background-color: #f0f0f0; color: #333; font-weight: bold; font-size: 1.1em;
            border-radius: 5px; transition: background-color 0.2s;
        }
        #accessibilityFloater button:hover { background-color: #e0e0e0; }
        .dark-theme #accessibilityFloater { background: rgba(30, 30, 30, 0.8); border: 1px solid #444; }
        .dark-theme #accessibilityFloater button { background-color: #2c2c2c; color: #f4f4f4; border-color: #03dac6; }
        .dark-theme #accessibilityFloater button:hover { background-color: #383838; }

        /* ‚ö†Ô∏è 6. AJUSTES VLIBRAS (Desktop e Mobile) */
        /* AJUSTE 3: Reposiciona VLibras na lateral direita, abaixo do centro (60% do topo) */
        div[vw] {
            position: fixed !important;
            right: 15px !important; 
            left: auto !important; 
            
            top: 60% !important; /* Ligeiramente abaixo do centro (50% seria o centro) */
            bottom: auto !important; 
            
            z-index: 998 !important; /* Acima do conte√∫do, abaixo de A+A- */
        }

        /* 7. ESTILOS DA BARRA DE PROGRESSO E CHECKBOX (MANTIDOS) */
        .progress-bar-wrapper { background-color: #ddd; border-radius: 10px; height: 10px; overflow: hidden; box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2); }
        .progress-bar { height: 100%; width: 0%; background-color: #28a745; border-radius: 10px; transition: width 0.5s ease-in-out; }
        .dark-theme #progressLabel { color: #03dac6; }
        .dark-theme .progress-bar-wrapper { background-color: #333; }
        .dark-theme .progress-bar { background-color: #03dac6; }
        .progress-check {
             display: flex; align-items: center; justify-content: center; margin: 0; flex-grow: 0; flex-shrink: 0;
             padding: 5px 10px; background-color: #e6f7ff; border: 1px solid #b3e0ff; border-radius: 5px; transition: background-color 0.3s; order: 0;
        }
        .progress-check label { margin-left: 10px; font-weight: bold; color: #1e8449; cursor: pointer; }
        .progress-check input[type="checkbox"] { transform: scale(1.3); cursor: pointer; }
        .dark-theme .progress-check { background-color: #2c2c2c; border-color: #444; }
        .dark-theme .progress-check label { color: #03dac6; }
        #audioProgressContainer { height: 5px; width: 100%; background-color: #ddd; border-radius: 2px; overflow: hidden; margin-top: 5px; margin-bottom: 10px; }
        #audioProgressBar { height: 100%; width: 0%; background-color: #ffc107; transition: width 0.1s linear; }
        .dark-theme #audioProgressContainer { background-color: #333; }
        .dark-theme #audioProgressBar { background-color: #ffd600; }


        /* 8. MEDIA QUERIES (Ajustes para Celular - max-width: 600px) */
        @media (max-width: 600px) {
            
            /* FIX: Centraliza o conte√∫do no mobile */
            main { width: 100%; display: flex; justify-content: center; }

            /* AJUSTE 1 (Mobile): Zera a margem superior do cont√™iner */
            .book-container {
                padding: 20px 25px; width: 95%; 
                margin-top: 0; /* Zera o espa√ßamento superior */
                margin-bottom: 20px;
            }
            
            /* AJUSTE 2 (Mobile): Garante que A+A- fique fixo no canto superior direito (5px de margem) */
            #accessibilityFloater {
                position: fixed; top: 5px; right: 5px; transform: translateY(0); 
                flex-direction: row; padding: 5px;
                background: rgba(255, 255, 255, 0.9); border: 1px solid #ccc;
                border-radius: 8px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            }
            #accessibilityFloater button { margin: 0 2px; padding: 3px 6px; font-size: 1em; }

            /* AJUSTE 3 (Mobile): Reposiciona VLibras para ficar mais baixo (75% do topo) */
            div[vw] {
                top: 72% !important; /* Move para 72% da altura da tela */
                right: 5px !important; /* Ajusta a margem direita para ser menor no mobile */
            }
            
            /* Outros ajustes de mobile (Mantidos) */
            .top-utils { 
                gap: 10px; 
                width: 100%;
            }
            
            #listenToggle {
                width: auto; 
                order: initial; 
                margin-bottom: 0; 
            }

            .navigation { flex-direction: column; gap: 10px; }
            .navigation .nav-button { width: 100%; } 
            .progress-check { order: -1; width: 100%; }
        }

        /* MEDIA QUERY: Ajuste para telas muito pequenas, se necess√°rio */
        @media (max-width: 400px) {
            #accessibilityFloater { right: 5px; padding: 5px; }
        }
    </style>
</head>
<body class="light-theme">

    <div id="accessibilityFloater" title="Controles de Acessibilidade">
        <button id="fontSizeIncrease" title="Aumentar Tamanho da Fonte">A+</button>
        <button id="fontSizeDecrease" title="Diminuir Tamanho da Fonte">A-</button>
    </div>
    
    <main>
        <div class="book-container">
            <div class="top-utils">
                <div class="language-selector-wrapper">
                    <button id="langSelectButton" aria-haspopup="true" aria-expanded="false" title="Selecionar Idioma">
                        </button>
                    <div id="langDropdown" role="menu">
                        </div>
                </div>
                
                <button id="listenToggle" class="nav-button" title="Ouvir Conte√∫do" disabled>
                    </button>
                
                <button id="themeToggle" class="nav-button" title="Mudar Tema">
                    </button>
            </div>
            
            <div id="audioProgressContainer" style="display: none;">
                <div id="audioProgressBar" class="progress-bar"></div>
            </div>

            <h1 id="mainTitle">7 Dias para Encontrar Sua Identidade em Cristo (G√°latas) </h1>
            <p class="subtitle" id="subTitle">Como viver com prop√≥sito, gra√ßa e liberdade de verdade.</p>
            
            <div id="progressContainer" style="margin-bottom: 15px;">
                <p id="progressLabel" style="text-align: center; font-size: 0.9em; margin-bottom: 5px; color: #4b0082; font-weight: bold;"></p>
                <div class="progress-bar-wrapper">
                    <div id="progressBar" class="progress-bar"></div>
                </div>
            </div>
            <p id="pageCounter" style="text-align: right;"></p>
            
            <div id="devotionalContent">
                </div>

            <div class="navigation">
                <button id="prevButton" class="nav-button" disabled>‚Üê Anterior</button>
                
                <div class="progress-check">
                    <input type="checkbox" id="completedCheck">
                    <label for="completedCheck" id="checkLabel">Marcar como Conclu√≠do</label>
                </div>
                
                <button id="nextButton" class="nav-button">Pr√≥ximo ‚Üí</button>
            </div>
        </div>
    </main>
    <footer>
        <p>Devocional adaptado e criado por Alex Silva | <span id="footerText"></span></p>
    </footer>

    <script>
        // --- DADOS MULTI-IDIOMA E TEMA ---
        const flagMap = {
            'pt-BR': { icon: '<img src="https://flagicons.lipis.dev/flags/4x3/br.svg" class="lang-flag-dropdown" alt="Portugu√™s">', text: 'Portugu√™s', iconActive: '<img src="https://flagicons.lipis.dev/flags/4x3/br.svg" class="lang-flag-active" alt="Portugu√™s">' },
            'en-US': { icon: '<img src="https://flagicons.lipis.dev/flags/4x3/us.svg" class="lang-flag-dropdown" alt="English">', text: 'English', iconActive: '<img src="https://flagicons.lipis.dev/flags/4x3/us.svg" class="lang-flag-active" alt="English">' },
            'es-ES': { icon: '<img src="https://flagicons.lipis.dev/flags/4x3/es.svg" class="lang-flag-dropdown" alt="Espa√±ol">', text: 'Espa√±ol', iconActive: '<img src="https://flagicons.lipis.dev/flags/4x3/es.svg" class="lang-flag-active" alt="Espa√±ol">' },
            'fr-FR': { icon: '<img src="https://flagicons.lipis.dev/flags/4x3/fr.svg" class="lang-flag-dropdown" alt="Fran√ßais">', text: 'Fran√ßais', iconActive: '<img src="https://flagicons.lipis.dev/flags/4x3/fr.svg" class="lang-flag-active" alt="Fran√ßais">' }
        };
        
        const themeMap = {
            'light': { icon: '‚òÄÔ∏è', next: 'dark' },
            'dark': { icon: 'üåô', next: 'light' }
        };

        const SAVED_THEME = localStorage.getItem('theme') || 'light'; 
        const SAVED_LANG = localStorage.getItem('language') || 'pt-BR'; 

        let currentTheme = SAVED_THEME;
        
        // --- VARI√ÅVEIS DE ESTADO ---
        const totalDays = 7;
        let currentDay = 1;
        let currentLang = SAVED_LANG; 
        
        // NOVO TTS: Objetos da Web Speech API e vari√°veis de controle
        const synth = window.speechSynthesis; 
        let utterance = null; 
        let totalChars = 0; // Para calcular o progresso
        let ttsVoices = []; // Cache das vozes dispon√≠veis (CORRE√á√ÉO 1)
        let ttsInitialized = false; // Novo: Vari√°vel de controle para inicializa√ß√£o do TTS
        
        // CHAVE √öNICA DO DEVOCIONAL.
        const DEVOTIONAL_KEY = 'galatas_teen'; 
        
        // NOVO: VARI√ÅVEIS DE ESTADO DE ACESSIBILIDADE DE FONTE
        let currentFontSize = parseFloat(localStorage.getItem('fontSize')) || 1.0; 
        const FONT_STEP = 0.1; // Incremento de 10%
        const FONT_MAX = 1.4;  // Tamanho m√°ximo (140%)
        const FONT_MIN = 0.8;  // Tamanho m√≠nimo (80%)
        
        // --- DADOS MULTI-IDIOMA (Tradu√ß√µes) ---
        const translations = {
            'pt-BR': {
                mainTitle: "7 Dias para Encontrar Sua Identidade em Cristo (G√°latas)",
				subTitle: "Como viver com prop√≥sito, gra√ßa e liberdade de verdade.",
                dayTitle: "Dia",
                progressLabelPrefix: "Progresso: ",
                checkLabel: "Marcar como Conclu√≠do",
                navPrev: "‚Üê Anterior",
                navNext: "Pr√≥ximo ‚Üí",
                footerText: "Direitos Reservados 2024",
                themeLight: "üåô Modo Escuro", 
                themeDark: "‚òÄÔ∏è Modo Claro",
                listenStart: "üîä Ou√ßa Aqui", 
                listenStop: "üõë Parar Leitura",
                listenPause: "‚è∏Ô∏è Pausar √Åudio",
                listenResume: "‚ñ∂Ô∏è Continuar",
                noContentAlert: "Conte√∫do para leitura n√£o encontrado.",
                ttsLoading: "‚è≥ Carregando √Åudio...", 
                ttsUnsupported: "‚ùå √Åudio Indispon√≠vel", 
                versiculoChave: "Vers√≠culo Chave:", 
                resumoMeditacao: "Resumo:", 
                aplicacaoPratica: "Aplica√ß√£o Pr√°tica:", /* CHAVE CORRETA */
                oracaoLabel: "Ora√ß√£o:", 
            },
            'en-US': {
                mainTitle: "7 Days to Discover Your Identity in Christ (Galatians)",
				subTitle: "How to live with real purpose, grace, and true freedom.",
                dayTitle: "Day",
                progressLabelPrefix: "Progress: ",
                checkLabel: "Mark as Completed",
                navPrev: "‚Üê Previous",
                navNext: "Next ‚Üí",
                footerText: "All Rights Reserved 2024",
                themeLight: "üåô Dark Mode",
                themeDark: "‚òÄÔ∏è Light Mode",
                listenStart: "üîä Listen Here", 
                listenStop: "üõë Stop Reading",
                listenPause: "‚è∏Ô∏è Pause Audio",
                listenResume: "‚ñ∂Ô∏è Resume",
                noContentAlert: "Content for reading not found.",
                ttsLoading: "‚è≥ Loading Audio...", 
                ttsUnsupported: "‚ùå Audio Unavailable",
                versiculoChave: "Key Verse:", 
                resumoMeditacao: "Summary:", 
                aplicacaoPratica: "Practical Application:", /* CHAVE CORRETA */
                oracaoLabel: "Prayer:",
            },
            'es-ES': {
                mainTitle: "7 D√≠as para Encontrar tu Identidad en Cristo (G√°latas)",
				subTitle: "C√≥mo vivir con prop√≥sito, gracia y verdadera libertad.",	
                dayTitle: "D√≠a",
                progressLabelPrefix: "Progreso: ",
                checkLabel: "Marcar como Concluido",
                navPrev: "‚Üê Anterior",
                navNext: "Siguiente ‚Üí",
                footerText: "Todos los derechos reservados 2024",
                themeLight: "üåô Modo Oscuro",
                themeDark: "‚òÄÔ∏è Modo Claro",
                listenStart: "üîä Escuchar Aqu√≠", 
                listenStop: "üõë Detener Lectura",
                listenPause: "‚è∏Ô∏è Pausar Audio",
                listenResume: "‚ñ∂Ô∏è Continuar",
                noContentAlert: "Contenido para escuchar no encontrado.",
                ttsLoading: "‚è≥ Cargando Audio...", 
                ttsUnsupported: "‚ùå Audio No Disponible",
                versiculoChave: "Vers√≠culo Clave:", 
                resumoMeditacao: "Resumen:", 
                aplicacaoPratica: "Aplicaci√≥n Pr√°ctica:", /* CHAVE CORRIGIDA */
                oracaoLabel: "Oraci√≥n:",
            },
            'fr-FR': {
                mainTitle: "7 Jours pour D√©couvrir ton Identit√© en Christ (Galates)",
				subTitle: "Comment vivre avec un vrai but, de la gr√¢ce et une libert√© authentique",
                dayTitle: "Jour",
                progressLabelPrefix: "Progression : ",
                checkLabel: "Marquer comme Accomplie",
                navPrev: "‚Üê Pr√©c√©dent",
                navNext: "Suivant ‚Üí",
                footerText: "Tous droits r√©serv√©s 2024",
                themeLight: "üåô Mode Sombre",
                themeDark: "‚òÄÔ∏è Mode Clair",
                listenStart: "üîä √âcoutez Ici", 
                listenStop: "üõë Arr√™ter Lecture",
                listenPause: "‚è∏Ô∏è Pause Audio", 
                listenResume: "‚ñ∂Ô∏è Reprendre",
                noContentAlert: "Contenu √† lire introuvable.",
                ttsLoading: "‚è≥ Chargement Audio...", 
                ttsUnsupported: "‚ùå Audio Indispon√≠vel",
                versiculoChave: "Verset Cl√©:", 
                resumoMeditacao: "R√©sum√©:", 
                aplicacaoPratica: "Application Pratique:", /* CHAVE CORRIGIDA */
                oracaoLabel: "Pri√®re:",
            }
        };

        // --- ELEMENTOS DOM ---
        const mainTitle = document.getElementById('mainTitle');
        const subTitle = document.getElementById('subTitle');
        const progressLabel = document.getElementById('progressLabel');
        const checkLabel = document.getElementById('checkLabel');
        const prevButton = document.getElementById('prevButton');
        const nextButton = document.getElementById('nextButton');
        const completedCheck = document.getElementById('completedCheck');
        const devotionalContentDiv = document.getElementById('devotionalContent');
        const footerText = document.getElementById('footerText');
        const progressBar = document.getElementById('progressBar');

        // ELEMENTOS DOM TTS/TEMA
        const langSelectButton = document.getElementById('langSelectButton');
        const langDropdown = document.getElementById('langDropdown');
        const themeToggle = document.getElementById('themeToggle');
        const listenToggle = document.getElementById('listenToggle'); 
        const audioProgressContainer = document.getElementById('audioProgressContainer');
        const audioProgressBar = document.getElementById('audioProgressBar');


  // * FUN√á√ïES DE UTILIDADE *
    
        function handleCompletedCheck() {
			saveCompletion(currentDay, completedCheck.checked);

		if (completedCheck.checked && currentDay < totalDays) {
			nextDay();
    }
}
        
        // --- NOVO: FUN√á√ïES DE CONTROLE DE FONTE ---
        function updateFontSize() {
            // Define a vari√°vel CSS na raiz do documento
            document.documentElement.style.setProperty('--base-font-scale', currentFontSize.toFixed(2));
            localStorage.setItem('fontSize', currentFontSize.toFixed(2));
        }

        function increaseFontSize() {
            if (currentFontSize < FONT_MAX) {
                currentFontSize = Math.min(FONT_MAX, currentFontSize + FONT_STEP);
                updateFontSize();
            }
        }

        function decreaseFontSize() {
            if (currentFontSize > FONT_MIN) {
                currentFontSize = Math.max(FONT_MIN, currentFontSize - FONT_STEP);
                updateFontSize();
            }
        }
        
        // --- FUN√á√ïES DE TEMA ---
        function applyTheme(theme) {
            currentTheme = theme;
            localStorage.setItem('theme', theme);
            
            document.body.classList.remove('light-theme', 'dark-theme');
            document.body.classList.add(theme === 'dark' ? 'dark-theme' : 'light-theme');
        }

        function toggleDarkMode() {
            const newTheme = themeMap[currentTheme].next;
            applyTheme(newTheme);
            updateTexts(0);
        }

        function loadThemePreference() {
            applyTheme(SAVED_THEME);
        }
        
        // --- FUN√á√ïES DE IDIOMA (COM BANDEIRAS) ---
        function setLanguage(langCode) {
            currentLang = langCode;
            localStorage.setItem('language', langCode);
            
            // Parar a leitura ao trocar de idioma
            stopSpeaking(); 
            
            updateTexts(0);
            updateLanguageSelector();
            // Atualiza o estado visual para a nova l√≠ngua. 
            updateListenToggle('start'); 
        }

        function updateLanguageSelector() {
            if (!langSelectButton || !langDropdown) return;
            
            const currentFlag = flagMap[currentLang];
            // 1. Atualiza o bot√£o com a bandeira e nome do idioma ativo
            langSelectButton.innerHTML = currentFlag.iconActive + currentFlag.text;
            
            // 2. Limpa e reconstr√≥i o dropdown, excluindo o idioma ativo
            langDropdown.innerHTML = '';
            Object.keys(flagMap).forEach(lang => {
                if (lang !== currentLang) {
                    const flag = flagMap[lang];
                    const link = document.createElement('a');
                    link.innerHTML = flag.icon + flag.text; 
                    link.setAttribute('data-lang', lang);
                    link.setAttribute('href', '#'); 
                    
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        setLanguage(lang);
                        langDropdown.style.display = 'none';
                        // NOVO ARIA: fecha o dropdown, atualiza o status do bot√£o
                        langSelectButton.setAttribute('aria-expanded', 'false'); 
                    });
                    
                    langDropdown.appendChild(link);
                }
            });
        }

        // FUN√á√ÉO TTS: Fun√ß√µes de controle da barra de progresso do √°udio
        function resetAudioProgressBar(hide = false) {
            if (audioProgressBar) audioProgressBar.style.width = '0%';
            if (audioProgressContainer) {
                // Apenas esconde se for pedido, para n√£o piscar no in√≠cio
                audioProgressContainer.style.display = hide ? 'none' : 'block';
            }
        }
        
        // --- FUN√á√ÉO DE ATUALIZA√á√ÉO DE TEXTOS ---
        function updateTexts(direction = 1) { 
            const t = translations[currentLang] || translations['pt-BR']; 

            document.documentElement.lang = currentLang.split('-')[0];

            mainTitle.innerText = t.mainTitle;
            subTitle.innerText = t.subTitle;
            progressLabel.innerText = `${t.progressLabelPrefix}${t.dayTitle} ${currentDay} de ${totalDays}`;
            checkLabel.innerText = t.checkLabel;
            prevButton.innerText = t.navPrev;
            nextButton.innerText = t.navNext;
            footerText.innerText = t.footerText;
            
            // NOTE: themeToggle is now globally hidden, but the script updates are kept in case they are re-enabled
            if (currentTheme === 'light') {
                themeToggle.innerHTML = t.themeLight; 
            } else {
                themeToggle.innerHTML = t.themeDark; 
            }

            const contentLangKey = currentLang.substring(0, 2); 
            loadDevotionalContent(currentDay, contentLangKey, t);

            updateOverallProgress();

            if (window.speechSynthesis && window.speechSynthesis.speaking) {
                stopSpeaking(); 
            }
        }
        
        // --- FUN√á√ÉO DE CARREGAMENTO DE CONTE√öDO ---
        function loadDevotionalContent(day, contentLangKey, t) { 
            const data = devotionalContent[day] ? devotionalContent[day][contentLangKey] || devotionalContent[day]['pt'] : null;
            
            if (!data) {
                devotionalContentDiv.innerHTML = `<p style="text-align: center;">${t.noContentAlert || 'Conte√∫do n√£o dispon√≠vel para o Dia ${day} neste idioma.'}</p>`;
                return;
            }
            
            devotionalContentDiv.innerHTML = `
                <h2 id="dayTitle">${t.dayTitle} ${day}: ${data.h2}</h2>
                <div class="section">
                    <strong>${t.versiculoChave}</strong>
                    <p class="versiculos">${data.versiculos}</p>
                </div>
                <div class="section">
                    <strong>${t.resumoMeditacao}</strong>
                    <p>${data.resumo}</p>
                </div>
                <div class="section">
                    <strong>${t.aplicacaoPratica}</strong>
                    <p>${data.aplicacao}</p>
                </div>
                <p class="oracao-final">${t.oracaoLabel} ${data.oracao}</p>
            `;
            
            document.getElementById('pageCounter').innerText = `P√°gina ${day} de ${totalDays}`; 

            updateListenToggle('start'); 
        }
        
        // --- FUN√á√ïES DE NAVEGA√á√ÉO ---
        function nextDay() {
            stopSpeaking(); 
            if (currentDay < totalDays) {
                currentDay++;
                localStorage.setItem(`devotionalProgress_${DEVOTIONAL_KEY}`, currentDay);
                updateTexts(1);
            }
        }
        
        function prevDay() {
            stopSpeaking();
            if (currentDay > 1) {
                currentDay--;
                localStorage.setItem(`devotionalProgress_${DEVOTIONAL_KEY}`, currentDay);
                updateTexts(-1);
            }
        }

        // --- FUN√á√ïES DE LEITURA (TEXT-TO-SPEECH) ---
        
        function getVoiceForLanguage(langCode) {
            const desiredLang = langCode.toLowerCase();
            
            if (ttsVoices.length === 0) {
                console.warn('TTS: Vozes n√£o carregadas.');
                return null;
            }
            
            let voice = ttsVoices.find(v => v.lang.toLowerCase() === desiredLang && v.localService);
            if (!voice) {
                voice = ttsVoices.find(v => v.lang.toLowerCase() === desiredLang);
            }
            if (!voice) {
                const langPrefix = desiredLang.substring(0, 2);
                voice = ttsVoices.find(v => v.lang.toLowerCase().startsWith(langPrefix));
            }

            return voice || ttsVoices[0];
        }

        function speakContent() {
            const t = translations[currentLang] || translations['pt-BR']; 
            const contentElement = document.getElementById('devotionalContent');
            
            if (!synth || synth.speaking) {
                return;
            }

            const textToSpeak = contentElement.innerText || contentElement.textContent;

            if (!textToSpeak) {
                alert(t.noContentAlert || "Conte√∫do para leitura n√£o encontrado.");
                return;
            }

            totalChars = textToSpeak.length;
            resetAudioProgressBar();

            utterance = new SpeechSynthesisUtterance(textToSpeak);
            utterance.lang = currentLang;

            const voice = getVoiceForLanguage(currentLang);
            if (voice) {
                utterance.voice = voice;
            } else {
                alert(t.ttsUnsupported + " " + t.noContentAlert);
                stopSpeaking();
                return;
            }
            
            utterance.onboundary = (event) => {
                const progress = (event.charIndex / totalChars) * 100;
                if (audioProgressBar) audioProgressBar.style.width = `${progress}%`;
            };
            
            utterance.onend = () => {
                resetAudioProgressBar(true);
                updateListenToggle('start'); 
            };
            
            synth.speak(utterance);
            updateListenToggle('speaking'); 
        }

        function stopSpeaking() {
            if (synth && synth.speaking) {
                synth.cancel();
            }
            if (synth) {
                synth.cancel();
            }
            resetAudioProgressBar(true); 
            updateListenToggle('start'); 
        }
        
        function handleListenClick() {
            if (!synth || listenToggle.disabled) return;

            if (synth.speaking && !synth.paused) {
                // Pausar
                synth.pause();
                updateListenToggle('paused');
            } 
            else if (synth.paused) {
                // Continuar
                synth.resume();
                updateListenToggle('speaking');
            } 
            else if (!synth.speaking) {
                // Iniciar a leitura
                speakContent();
            }
        }
        
        function initTTS() {
            if (ttsInitialized) return; 
            const t = translations[currentLang] || translations['pt-BR']; 

            if (!synth) {
                listenToggle.innerHTML = t.ttsUnsupported;
                listenToggle.disabled = true;
                return;
            }

            synth.onvoiceschanged = () => {
                ttsVoices = synth.getVoices();
                if (ttsVoices.length > 0) {
                    listenToggle.disabled = false;
                    updateListenToggle('start'); 
                    ttsInitialized = true;
                } else {
                    listenToggle.innerHTML = t.ttsUnsupported;
                    listenToggle.disabled = true;
                }
            };
            
            ttsVoices = synth.getVoices();
            
            if (ttsVoices.length > 0) {
                listenToggle.disabled = false;
                updateListenToggle('start');
                ttsInitialized = true;
                synth.onvoiceschanged = null; 
            } else {
                listenToggle.innerHTML = t.ttsLoading;
                listenToggle.disabled = true;
            }
        }


        function updateListenToggle(state = 'start') {
            const t = translations[currentLang] || translations['pt-BR']; 
            const button = listenToggle;
            if (!button) return;

            button.style.cssText = ''; 
            
            if (state === 'speaking') {
                button.innerHTML = t.listenPause || '‚è∏Ô∏è Pausar √Åudio';
                button.title = 'Pausar a leitura';
                button.style.backgroundColor = '#ffc107'; 
                button.style.color = '#333';
                
            } else if (state === 'paused') {
                button.innerHTML = t.listenResume || '‚ñ∂Ô∏è Continuar';
                button.title = 'Continuar a leitura';
                button.style.backgroundColor = '#28a745'; 
                button.style.color = 'white';
                
            } else { // state === 'start' (Ocioso/Parado)
                button.innerHTML = t.listenStart || 'üîä Ou√ßa Aqui';
                button.title = 'Iniciar a leitura do devocional';
            }
        }


         // --- CONTE√öDO DEVOCIONAL (COMPLETO) ---
        
        const devotionalContent = {
  "1": {"pt": {"h2": "O Evangelho sem 'Filtro' ou 'Upgrades' (Sola Gratia)", "versiculos": "G√°latas 1:8-9 (NVT): Que seja amaldi√ßoado qualquer um, incluindo n√≥s, ou mesmo um anjo do c√©u, que anunciar boas-novas diferentes das que n√≥s lhes anunciamos.", "resumo": "Existe s√≥ uma Mensagem Oficial de Deus para a salva√ß√£o, e ela √© totalmente gr√°tis. √â a justifica√ß√£o pela f√© em Jesus, *sem precisar de nenhum upgrade* ou 'conte√∫do premium' que voc√™ tenha que pagar com seu esfor√ßo (tipo seguir rituais ou regras sociais). Se algu√©m te disser que ser 'aceito' por Deus exige algo al√©m de Cristo, essa pessoa est√° pregando uma fake news espiritual. Ou √© 100% Gra√ßa, ou n√£o √© Gra√ßa.", "aplicacao": "Onde voc√™ tem buscado valida√ß√£o ou um 'n√≠vel VIP' com Deus? Voc√™ sente que precisa ser o melhor aluno, o mais popular ou o super crente para Ele te amar? Pare de tentar hackear a salva√ß√£o. Descanse na sufici√™ncia de Cristo: o pre√ßo j√° foi pago.", "oracao": "Deus, eu te agrade√ßo porque o Seu Evangelho √© puro e completo. Me ajuda a n√£o cair na armadilha de tentar 'merecer' Seu amor ou de sentir que sou melhor ou pior que os outros por causa do meu desempenho. Que eu viva pela Sua Gra√ßa. Am√©m."}, "en": {"h2": "The Gospel no 'Filter' or 'Upgrades' (Sola Gratia)", "versiculos": "Galatians 1:8-9 (NVT adapted): May anyone, including us, or even an angel from heaven, who announces good news different from what we announced to you, be cursed.", "resumo": "There is only one Official Message from God for salvation, and it is totally free. It‚Äôs justification by faith in Jesus, *without needing any upgrade* or 'premium content' you have to pay for with your effort (like following rituals or social rules). If someone tells you that being 'accepted' by God requires anything beyond Christ, that person is preaching spiritual fake news. It‚Äôs either 100% Grace, or it‚Äôs no Grace at all.", "aplicacao": "Where have you been looking for validation or a 'VIP level' with God? Do you feel you need to be the top student, the most popular, or the super Christian for Him to love you more? Stop trying to hack salvation. Rest in the sufficiency of Christ: the price has already been paid.", "oracao": "God, I thank You because Your Gospel is pure and complete. Help me not to fall into the trap of trying to 'earn' Your love or feeling like I am better or worse than others because of my performance. May I live by Your Grace. Amen!"}, "es": {"h2": "El Evangelio sin 'Filtro' ni 'Upgrades' (Sola Gratia)", "versiculos": "G√°latas 1:8-9 (NVT adaptado): Que sea maldecido cualquiera, incluy√©ndonos, o incluso un √°ngel del cielo, que les anuncie buenas nuevas diferentes de las que les anunciamos.", "resumo": "Solo hay un Mensaje Oficial de Dios para la salvaci√≥n, y es totalmente gratis. Es la justificaci√≥n por la fe en Jes√∫s, *sin necesidad de ning√∫n upgrade* o 'contenido premium' que tengas que pagar con tu esfuerzo (como seguir rituales o reglas sociales). Si alguien te dice que ser 'aceptado' por Dios requiere algo m√°s que Cristo, esa persona est√° predicando una fake news espiritual. O es 100% Gracia, o no es Gracia.", "aplicacao": "¬øD√≥nde has estado buscando validaci√≥n o un 'nivel VIP' con Dios? ¬øSientes que tienes que ser el mejor estudiante, el m√°s popular o el s√∫per creyente para que √âl te ame m√°s? Deja de intentar hackear la salvaci√≥n. Descansa en la suficiencia de Cristo: el precio ya fue pagado.", "oracao": "Dios, te agradezco porque Tu Evangelio es puro y completo. Ay√∫dame a no caer en la trampa de intentar 'merecer' Tu amor o de sentirme mejor o peor que otros por mi desempe√±o. Que viva por Tu Gracia. Am√©n."}, "fr": {"h2": "L'√âvangile sans 'Filtre' ni 'Mises √† Jour' (Sola Gratia)", "versiculos": "Galates 1:8-9 (NVT adapt√©): Que quiconque, y compris nous ou m√™me un ange du ciel, qui vous annoncerait une bonne nouvelle diff√©rente de celle que nous vous avons annonc√©e, soit maudit.", "resumo": "Il n'y a qu'un seul Message Officiel de Dieu pour le salut, et il est totalement gratuit. C'est la justification par la foi en J√©sus, *sans avoir besoin de mise √† jour* ou de 'contenu premium' que tu doives payer avec tes efforts (comme suivre des rituels ou des r√®gles sociales). Si quelqu'un te dit qu'√™tre 'accept√©' par Dieu exige quelque chose au-del√† du Christ, cette personne pr√™che une fausse nouvelle spirituelle. C'est soit 100% Gr√¢ce, soit ce n'est pas la Gr√¢ce.", "aplicacao": "O√π as-tu cherch√© la validation ou un 'niveau VIP' avec Dieu? As-tu l'impression que tu dois √™tre le meilleur √©l√®ve, le plus populaire ou le super chr√©tien pour qu'Il t'aime davantage? Arr√™te d'essayer de hacker le salut. Repose-toi sur la suffisance du Christ: le prix a d√©j√† √©t√© pay√©.", "oracao": "Dieu, je Te remercie parce que Ton √âvangile est pur et complet. Aide-moi √† ne pas tomber dans le pi√®ge d'essayer de 'm√©riter' Ton amour ou de me sentir meilleur ou pire que les autres √† cause de ma performance. Que je vive par Ta Gr√¢ce. Amen!"}},
  "2": {"pt": {"h2": "O 'Eu' Antigo Foi Cancelado", "versiculos": "G√°latas 2:20 (NVT): Fui crucificado com Cristo; assim, j√° n√£o sou eu quem vive, mas Cristo vive em mim. Portanto, vivo neste corpo terreno pela f√© no Filho de Deus, que me amou e se entregou por mim.", "resumo": "Quando voc√™ aceitou Jesus, o seu 'username' antigo, cheio de erros e v√≠cios, foi 'cancelado' junto com Ele na cruz. Agora, a sua identidade verdadeira √© baseada em Cristo vivendo em voc√™. Voc√™ n√£o precisa mais se esfor√ßar para se provar; voc√™ vive pela confian√ßa total (f√©) no amor dEle.", "aplicacao": "Qual √© o seu maior medo hoje: ser rejeitado, n√£o passar na prova, n√£o ter likes? Lembre-se: sua vida n√£o √© mais sobre o seu ego ou sua performance. Sua vida √© sobre Jesus. Quando a press√£o vier, respire e diga: 'Eu sou amado, e Ele vive em mim.'", "oracao": "Jesus, o meu 'eu' antigo est√° morto. Obrigado porque Voc√™ me deu uma nova vida e um novo 'status' com Deus. Ajude-me a viver todos os dias pela f√© e n√£o pelo que as pessoas pensam ou pelo que eu consigo fazer sozinho. Am√©m!"}, "en": {"h2": "The Old 'Me' Got Cancelled", "versiculos": "Galatians 2:20 (NVT): I have been crucified with Christ; thus, it is no longer I who live, but Christ lives in me. Therefore, I live in this earthly body by faith in the Son of God, who loved me and gave himself for me.", "resumo": "When you accepted Jesus, your old 'username', full of mistakes and bad habits, was 'cancelled' along with Him on the cross. Now, your true identity is based on Christ living in you. You no longer need to strive to prove yourself; you live by total trust (faith) in His love.", "aplicacao": "What is your biggest fear today: being rejected, failing a test, not getting likes? Remember: your life is no longer about your ego or your performance. Your life is about Jesus. When pressure comes, breathe and say: 'I am loved, and He lives in me.'", "oracao": "Jesus, my old self is dead. Thank you because You gave me a new life and a new 'status' with God. Help me to live every day by faith and not by what people think or what I can achieve alone. Amen!"}, "es": {"h2": "El 'Yo' Antiguo Fue Cancelado", "versiculos": "G√°latas 2:20 (NVT): He sido crucificado con Cristo; as√≠ que ya no soy yo quien vive, sino que Cristo vive en m√≠. Por lo tanto, vivo en este cuerpo terrenal por la fe en el Hijo de Dios, quien me am√≥ y se entreg√≥ por m√≠.", "resumo": "Cuando aceptaste a Jes√∫s, tu 'nombre de usuario' antiguo, lleno de errores y malos h√°bitos, fue 'cancelado' junto con √âl en la cruz. Ahora, tu verdadera identidad se basa en Cristo viviendo en ti. Ya no necesitas esforzarte para demostrar tu val√≠a; vives por la confianza total (fe) en Su amor.", "aplicacao": "¬øCu√°l es tu mayor miedo hoy: ser rechazado, reprobar un examen, no tener likes? Recuerda: tu vida ya no se trata de tu ego o tu desempe√±o. Tu vida se trata de Jes√∫s. Cuando llegue la presi√≥n, respira y di: 'Soy amado, y √âl vive en m√≠.'", "oracao": "Jes√∫s, mi 'yo' antiguo est√° muerto. Gracias porque me diste una vida nueva y un nuevo 'status' con Dios. Ay√∫dame a vivir todos los d√≠as por la fe y no por lo que la gente piense o lo que pueda lograr solo. Am√©n."}, "fr": {"h2": "L'Ancien 'Moi' Est Annul√©", "versiculos": "Galates 2:20 (NVT adapt√©): J‚Äôai √©t√© crucifi√© avec Christ; ainsi, ce n‚Äôest plus moi qui vis, mais Christ vit en moi. Par cons√©quent, je vis dans ce corps terrestre par la foi au Fils de Dieu, qui m‚Äôa aim√© et s‚Äôest donn√© pour moi.", "resumo": "Quand tu as accept√© J√©sus, ton ancien 'nom d'utilisateur', rempli d'erreurs et de mauvaises habitudes, a √©t√© 'annul√©' avec Lui sur la croix. Maintenant, ta v√©ritable identit√© est bas√©e sur Christ vivant en toi. Tu n'as plus besoin de t'efforcer de faire tes preuves; tu vis par la confiance totale (foi) en Son amour.", "aplicacao": "Quelle est ta plus grande peur aujourd'hui: √™tre rejet√©, √©chouer √† un test, ne pas avoir de likes? Souviens-toi: ta vie ne tourne plus autour de ton ego ou de ta performance. Ta vie tourne autour de J√©sus. Lorsque la pression arrive, respire et dis: 'Je suis aim√©, et Il vit en moi.'", "oracao": "J√©sus, mon ancien 'moi' est mort. Merci parce que Tu m'as donn√© une vie nouvelle et un nouveau 'statut' aupr√®s de Dieu. Aide-moi √† vivre chaque jour par la foi et non par ce que les gens pensent ou ce que je peux accomplir seul. Amen!"}},
  "3": {"pt": {"h2": "Modo 'Fa√ßa Voc√™ Mesmo' Desativado", "versiculos": "G√°latas 3:3 (NVT): Ser√° que perderam o ju√≠zo? Tendo come√ßado no Esp√≠rito, por que agora procuram tornar-se perfeitos por seus pr√≥prios esfor√ßos?", "resumo": "√â a maior burrada (perder o ju√≠zo) tentar 'se aperfei√ßoar' ou ser um crist√£o n√≠vel m√°ximo usando s√≥ a sua for√ßa de vontade. Se Deus te salvou pelo poder do Esp√≠rito (o in√≠cio), Ele √© quem vai te ajudar a viver essa vida (o *upgrade*). Tentar viver a vida crist√£ no 'Modo Fa√ßo Sozinho' (pr√≥prios esfor√ßos) √© um downgrade e s√≥ leva ao burnout.", "aplicacao": "Onde voc√™ est√° tentando ser bom demais ou perfeito demais para ser notado? Voc√™ est√° exausto tentando agradar a todos? Se entregue ao Esp√≠rito. O Esp√≠rito Santo est√° l√° para ser o seu Guia e Coach pessoal. N√£o desative Ele! Confie 100% Nele.", "oracao": "Esp√≠rito Santo, eu cansei de tentar ser suficiente sozinho. Desligo agora o 'Modo Fa√ßo Voc√™ Mesmo'. Eu preciso do Seu poder para fazer o que √© certo. Por favor, me guia, me ensina e me d√° a for√ßa para viver a Sua vontade. Am√©m!"}, "en": {"h2": "DIY Mode Disabled", "versiculos": "Galatians 3:3 (NVT): Have you lost your minds? Having begun in the Spirit, why are you now trying to be made complete by your own efforts?", "resumo": "It's the biggest mistake (losing your mind) to try to 'perfect yourself' or be a max-level Christian using only your willpower. If God saved you by the Spirit's power (the start), He is the one who will help you live this life (the *upgrade*). Trying to live the Christian life in 'DIY Mode' (own efforts) is a downgrade and only leads to burnout.", "aplicacao": "Where are you trying to be too good or too perfect to get noticed? Are you exhausted trying to please everyone? Surrender to the Spirit. The Holy Spirit is there to be your personal Guide and Coach. Don't disable Him! Trust Him 100%.", "oracao": "Holy Spirit, I'm tired of trying to be enough on my own. I'm turning off 'DIY Mode' now. I need Your power to do what is right. Please, guide me, teach me, and give me the strength to live out Your will. Amen!"}, "es": {"h2": "Modo 'Hazlo T√∫ Mismo' Desactivado", "versiculos": "G√°latas 3:3 (NVT): ¬øHan perdido el juicio? Habiendo comenzado con el Esp√≠ritu, ¬øpor qu√© ahora procuran ser perfeccionados por sus propios esfuerzos?", "resumo": "Es el mayor error (perder el juicio) intentar 'perfeccionarse' o ser un cristiano de nivel m√°ximo usando solo tu fuerza de voluntad. Si Dios te salv√≥ por el poder del Esp√≠ritu (el inicio), √âl es quien te ayudar√° a vivir esta vida (el *upgrade*). Intentar vivir la vida cristiana en 'Modo Hazlo T√∫ Mismo' (esfuerzos propios) es un *downgrade* y solo lleva al agotamiento.", "aplicacao": "¬øD√≥nde est√°s intentando ser demasiado bueno o demasiado perfecto para que te noten? ¬øEst√°s agotado tratando de complacer a todos? Entr√©gate al Esp√≠ritu. El Esp√≠ritu Santo est√° all√≠ para ser tu Gu√≠a y Coach personal. ¬°No lo desactives! Conf√≠a 100% en √âl.", "oracao": "Esp√≠ritu Santo, me cans√© de intentar ser suficiente por mi cuenta. Desactivo ahora el 'Modo Hazlo T√∫ Mismo'. Necesito Tu poder para hacer lo correcto. Por favor, gu√≠ame, ens√©√±ame y dame la fuerza para vivir Tu voluntad. Am√©n."}, "fr": {"h2": "Mode 'Fais-Le Toi-M√™me' D√©sactiv√©", "versiculos": "Galates 3:3 (NVT adapt√©): Avez-vous perdu la t√™te? Apr√®s avoir commenc√© par l'Esprit, pourquoi cherchez-vous maintenant √† √™tre rendus parfaits par vos propres efforts?", "resumo": "C'est la plus grande b√™tise (perdre la t√™te) d'essayer de 'te perfectionner' ou d'√™tre un chr√©tien niveau max en utilisant uniquement ta volont√©. Si Dieu t'a sauv√© par la puissance de l'Esprit (le d√©but), c'est Lui qui t'aidera √† vivre cette vie (la *mise √† jour*). Essayer de vivre la vie chr√©tienne en 'Mode Fais-Le Toi-M√™me' (tes propres efforts) est une r√©gression et ne m√®ne qu'√† l'√©puisement.", "aplicacao": "O√π essaies-tu d'√™tre trop bon ou trop parfait pour √™tre remarqu√©? Es-tu √©puis√© d'essayer de plaire √† tout le monde? Abandonne-toi √† l'Esprit. Le Saint-Esprit est l√† pour √™tre ton Guide et Coach personnel. Ne le d√©sactive pas! Fais-lui confiance √† 100%.", "oracao": "Saint-Esprit, je suis fatigu√© d'essayer d'√™tre suffisant par moi-m√™me. J'√©teins maintenant le 'Mode Fais-Le Toi-M√™me'. J'ai besoin de Ta puissance pour faire ce qui est juste. S'il Te pla√Æt, guide-moi, enseigne-moi et donne-moi la force de vivre Ta volont√©. Amen!"}},
  "4": {"pt": {"h2": "Voc√™ N√£o √© Escravo, Voc√™ √© 'Herdeiro(a) VIP'", "versiculos": "G√°latas 4:4-7 (NVT): E, porque n√≥s somos seus filhos, Deus enviou ao nosso cora√ß√£o o Esp√≠rito de seu Filho, e por meio dele clamamos: 'Aba, Pai'. Agora voc√™ j√° n√£o √© escravo, mas filho de Deus. E, uma vez que √© filho, Deus o tornou herdeiro dele.", "resumo": "Jesus veio para fazer um resgate radical: Ele te tirou do *status* de escravo (algu√©m que s√≥ obedece por medo) e te deu o *status* de Filho(a) Adotado(a) com acesso total. O Esp√≠rito Santo em voc√™ te d√° a confian√ßa para chamar o Deus Criador de 'Papai Querido' (Aba, Pai). Voc√™ n√£o √© mais um servo, mas um herdeiro com privil√©gios.", "aplicacao": "Voc√™ tem agido com a press√£o de um escravo que teme puni√ß√£o ou com a seguran√ßa de um filho que sabe que √© amado? Sua heran√ßa (o C√©u e todas as b√™n√ß√£os) √© sua! Viva com essa confian√ßa de herdeiro, querendo obedecer por amor e n√£o por medo de ser 'descurtido' por Deus.", "oracao": "Aba, Pai. Minha identidade √© em Ti! Obrigado por me tirar da escravid√£o e me fazer Seu herdeiro. Tira de mim todo o medo de n√£o ser bom o suficiente. Que eu viva hoje com a confian√ßa de um filho/filha que √© totalmente amado(a). Am√©m!"}, "en": {"h2": "You're Not a Slave, You're a 'VIP Heir'", "versiculos": "Galatians 4:4-7 (NVT): And because we are His children, God sent the Spirit of His Son into our hearts, and through Him we cry out: 'Abba, Father'. Now you are no longer a slave, but a child of God. And since you are a child, God has made you His heir.", "resumo": "Jesus came to make a radical rescue: He took you out of the slave *status* (someone who only obeys out of fear) and gave you the *status* of Adopted Child with full access. The Holy Spirit in you gives you the confidence to call the Creator God 'Dear Daddy' (Abba, Father). You are no longer a servant, but an heir with privileges.", "aplicacao": "Are you acting with the pressure of a slave who fears punishment or with the security of a child who knows they are loved? Your inheritance (Heaven and all blessings) is yours! Live with that heir confidence, wanting to obey out of love and not out of fear of being 'unliked' by God.", "oracao": "Abba, Father. My identity is in You! Thank you for taking me out of slavery and making me Your heir. Take away all fear of not being good enough. May I live today with the confidence of a son/daughter who is fully loved. Amen!"}, "es": {"h2": "No Eres un Esclavo, Eres un 'Heredero(a) VIP'", "versiculos": "G√°latas 4:4-7 (NVT): Y puesto que somos sus hijos, Dios envi√≥ a nuestro coraz√≥n el Esp√≠ritu de su Hijo, por medio del cual clamamos: '¬°Aba, Padre!' Ahora ya no eres esclavo, sino hijo de Dios. Y, puesto que eres hijo, Dios tambi√©n te ha hecho heredero de √©l.", "resumo": "Jes√∫s vino para hacer un rescate radical: Te sac√≥ del *status* de esclavo (alguien que solo obedece por miedo) y te dio el *status* de Hijo(a) Adoptado(a) con acceso total. El Esp√≠ritu Santo en ti te da la confianza para llamar al Dios Creador 'Pap√° Querido' (Aba, Padre). Ya no eres un siervo, sino un heredero con privilegios.", "aplicacao": "¬øEst√°s actuando con la presi√≥n de un esclavo que teme el castigo o con la seguridad de un hijo que sabe que es amado? ¬°Tu herencia (el Cielo y todas las bendiciones) es tuya! Vive con esa confianza de heredero, queriendo obedecer por amor y no por miedo a que Dios te d√© 'unfollow'.", "oracao": "Aba, Padre. ¬°Mi identidad est√° en Ti! Gracias por sacarme de la esclavitud y hacerme Tu heredero. Quita de m√≠ todo miedo a no ser lo suficientemente bueno. Que viva hoy con la confianza de un hijo/hija que es totalmente amado(a). Am√©n."}, "fr": {"h2": "Tu n'es Pas un Esclave, Tu es un 'H√©ritier VIP'", "versiculos": "Galates 4:4-7 (NVT adapt√©): Et parce que nous sommes Ses enfants, Dieu a envoy√© dans notre c≈ìur l'Esprit de Son Fils, par lequel nous crions: 'Abba, P√®re!' Maintenant, tu n'es plus esclave, mais enfant de Dieu. Et, puisque tu es enfant, Dieu t'a aussi fait Son h√©ritier.", "resumo": "J√©sus est venu pour faire un sauvetage radical: Il t'a fait passer du *statut* d'esclave (quelqu'un qui ob√©it seulement par peur) au *statut* d'Enfant Adopt√© avec acc√®s total. Le Saint-Esprit en toi te donne la confiance d'appeler le Dieu Cr√©ateur 'Papa Ch√©ri' (Abba, P√®re). Tu n'es plus un serviteur, mais un h√©ritier avec des privil√®ges.", "aplicacao": "Agis-tu avec la pression d'un esclave qui craint la punition ou avec la s√©curit√© d'un enfant qui sait qu'il est aim√©? Ton h√©ritage (le Ciel et toutes les b√©n√©dictions) est tien! Vis avec cette confiance d'h√©ritier, voulant ob√©ir par amour et non par peur d'√™tre 'd√©saim√©' par Dieu.", "oracao": "Abba, P√®re. Mon identit√© est en Toi! Merci de m'avoir lib√©r√© de l'esclavage et de m'avoir fait Ton h√©ritier. Enl√®ve toute peur de ne pas √™tre assez bon. Que je vive aujourd'hui avec la confiance d'un fils/fille qui est totalement aim√©(e). Amen!"}},
  "5": {"pt": {"h2": "A Liberdade √© Aut√™ntica. Mantenha o Foco!", "versiculos": "G√°latas 5:1 (NVT): Portanto, permane√ßam firmes nessa liberdade, pois Cristo verdadeiramente nos libertou. N√£o se submetam novamente √† escravid√£o da lei.", "resumo": "Cristo te deu a liberdade definitiva. Voc√™ n√£o tem que fingir ser perfeito ou seguir uma lista intermin√°vel de 'regras de igreja' para ser salvo. Essa √© a Liberdade da Gra√ßa! O perigo √© a galera do legalismo te pressionar a voltar para a escravid√£o das regras (*submeter-se novamente √† escravid√£o da lei*). Mantenha o foco: voc√™ √© livre em Cristo. Fim de papo.", "aplicacao": "Quais press√µes externas ou internas (tipo 'se eu n√£o fizer X, Deus n√£o me aceita') est√£o te roubando a alegria? Identifique-as e corte o drama. Use sua liberdade para o que realmente importa: servir e amar as pessoas (vers√≠culo 13). Essa √© a prova de que a sua f√© √© aut√™ntica.", "oracao": "Jesus, obrigado por me dar a liberdade de ser aut√™ntico(a) em Ti. Me ajuda a identificar e rejeitar toda a press√£o para ser 'perfeito' pelas minhas for√ßas. Que eu use a minha liberdade para amar e servir a quem est√° perto de mim. Am√©m!"}, "en": {"h2": "Freedom is Authentic. Stay Focused!", "versiculos": "Galatians 5:1 (NVT): Therefore, stand firm in that freedom, for Christ has truly set us free. Do not submit again to the slavery of the law.", "resumo": "Christ gave you ultimate freedom. You don't have to pretend to be perfect or follow an endless list of 'church rules' to be saved. This is the Freedom of Grace! The danger is for the legalism crowd to pressure you to go back to the slavery of rules (*submit again to the slavery of the law*). Stay focused: you are free in Christ. Period.", "aplicacao": "What external or internal pressures (like 'if I don't do X, God won't accept me') are stealing your joy? Identify them and cut the drama. Use your freedom for what truly matters: serving and loving people (verse 13). That‚Äôs proof that your faith is authentic.", "oracao": "Jesus, thank you for giving me the freedom to be authentic in You. Help me identify and reject all pressure to be 'perfect' by my own strength. May I use my freedom to love and serve those around me. Amen!"}, "es": {"h2": "La Libertad es Aut√©ntica. ¬°Mantente Enfocado!", "versiculos": "G√°latas 5:1 (NVT): Por lo tanto, permanezcan firmes en esa libertad, porque Cristo verdaderamente nos liber√≥. No se sometan de nuevo a la esclavitud de la ley.", "resumo": "Cristo te dio la libertad definitiva. No tienes que fingir ser perfecto o seguir una lista interminable de 'reglas de la iglesia' para ser salvo. ¬°Esta es la Libertad de la Gracia! El peligro es que la gente del legalismo te presione para volver a la esclavitud de las reglas (*someterse de nuevo a la esclavitud de la ley*). Mantente enfocado: eres libre en Cristo. Punto final.", "aplicacao": "¬øQu√© presiones externas o internas (como 'si no hago X, Dios no me acepta') te est√°n robando la alegr√≠a? Identif√≠calas y corta el drama. Usa tu libertad para lo que realmente importa: servir y amar a la gente (vers√≠culo 13). Esa es la prueba de que tu fe es aut√©ntica.", "oracao": "Jes√∫s, gracias por darme la libertad de ser aut√©ntico en Ti. Ay√∫dame a identificar y rechazar toda la presi√≥n para ser 'perfecto' por mis fuerzas. Que use mi libertad para amar y servir a quienes est√°n cerca de m√≠. Am√©n."}, "fr": {"h2": "La Libert√© Est Authentique. Garde le Focus!", "versiculos": "Galates 5:1 (NVT adapt√©): Demeurez donc fermes dans cette libert√©, car Christ nous a v√©ritablement lib√©r√©s. Ne vous soumettez plus √† l‚Äôesclavage de la loi.", "resumo": "Christ t'a donn√© la libert√© ultime. Tu n'as pas √† faire semblant d'√™tre parfait ou √† suivre une liste interminable de 'r√®gles d'√©glise' pour √™tre sauv√©. C'est la Libert√© de la Gr√¢ce! Le danger est que les gens du l√©galisme te poussent √† revenir √† l'esclavage des r√®gles (*vous soumettre √† nouveau √† l‚Äôesclavage de la loi*). Garde le focus: tu es libre en Christ. Point.", "aplicacao": "Quelles pressions externes ou internes (du genre 'si je ne fais pas X, Dieu ne m'accepte pas') te volent ta joie? Identifie-les et coupe court au drame. Utilise ta libert√© pour ce qui compte vraiment: servir et aimer les gens (verset 13). C'est la preuve que ta foi est authentique.", "oracao": "J√©sus, merci de m'avoir donn√© la libert√© d'√™tre authentique en Toi. Aide-moi √† identifier et √† rejeter toute pression pour √™tre 'parfait' par mes propres forces. Que j'utilise ma libert√© pour aimer et servir ceux qui sont proches de moi. Amen!"}},
  "6": {"pt": {"h2": "A Batalha Interna: O 'Ego' vs. O Esp√≠rito", "versiculos": "G√°latas 5:16-17 (NVT): Por isso digo: deixem que o Esp√≠rito guie sua vida. Assim, n√£o satisfar√£o os anseios de sua natureza humana. A natureza humana deseja fazer exatamente o oposto do que o Esp√≠rito quer...", "resumo": "Sua vida √© como um campo de batalha interno: sua 'natureza humana' (o 'Ego' ou a 'Carne') quer te levar a fazer coisas que parecem *boas na hora*, mas que te destroem (raiva, inveja, fofoca). O Esp√≠rito Santo quer te guiar para o que √© certo. Essa √© a guerra. O segredo √©: deixar o Esp√≠rito guiar ‚Äî dar a Ele o controle do seu feed, das suas atitudes e do seu tempo.", "aplicacao": "Voc√™ tem sido 'arrastado' pelas suas emo√ß√µes e impulsos? O Esp√≠rito √© o seu Melhor Conselheiro. Antes de reagir com raiva, antes de fofocar ou reclamar, fa√ßa uma pausa e pergunte: 'O que o Esp√≠rito faria aqui?' Pratique isso, e voc√™ vencer√° a batalha.", "oracao": "Deus, eu confesso: a minha natureza humana tenta me controlar. Eu escolho entregar a Voc√™ a lideran√ßa da minha vida. Esp√≠rito Santo, guia a minha vida hoje, controla minhas rea√ß√µes e me d√° poder para n√£o ceder aos meus piores impulsos. Am√©m!"}, "en": {"h2": "The Internal Battle: 'Ego' vs. The Spirit", "versiculos": "Galatians 5:16-17 (NVT): So I say, let the Spirit guide your lives. Then you won‚Äôt be doing what your sinful nature craves. The sinful nature craves that which is contrary to the Spirit...", "resumo": "Your life is like an internal battleground: your 'human nature' (the 'Ego' or the 'Flesh') wants to lead you to do things that feel *good at the moment* but destroy you (anger, envy, gossip). The Holy Spirit wants to guide you to what is right. This is the war. The secret is: let the Spirit guide ‚Äî give Him control of your feed, your attitudes, and your time.", "aplicacao": "Have you been 'dragged along' by your emotions and impulses? The Spirit is your Best Counselor. Before reacting with anger, before gossiping or complaining, take a break and ask: 'What would the Spirit do here?' Practice this, and you will win the battle.", "oracao": "God, I confess: my human nature tries to control me. I choose to hand over leadership of my life to You. Holy Spirit, guide my life today, control my reactions, and empower me not to give in to my worst impulses. Amen!"}, "es": {"h2": "La Batalla Interna: El 'Ego' vs. El Esp√≠ritu", "versiculos": "G√°latas 5:16-17 (NVT): Por eso les digo: dejen que el Esp√≠ritu gu√≠e su vida. As√≠, no satisfar√°n los deseos de su naturaleza pecaminosa. La naturaleza pecaminosa desea hacer exactamente lo opuesto a lo que quiere el Esp√≠ritu...", "resumo": "Tu vida es como un campo de batalla interno: tu 'naturaleza humana' (el 'Ego' o la 'Carne') quiere llevarte a hacer cosas que parecen *buenas en el momento*, pero que te destruyen (ira, envidia, chismes). El Esp√≠ritu Santo quiere guiarte hacia lo correcto. Esta es la guerra. El secreto es: deja que el Esp√≠ritu gu√≠e ‚Äî dale el control de tu feed, tus actitudes y tu tiempo.", "aplicacao": "¬øTe has dejado 'arrastrar' por tus emociones e impulsos? El Esp√≠ritu es tu Mejor Consejero. Antes de reaccionar con ira, antes de chismear o quejarte, haz una pausa y pregunta: '¬øQu√© har√≠a el Esp√≠ritu aqu√≠?' Practica esto y ganar√°s la batalla.", "oracao": "Dios, confieso: mi naturaleza humana intenta controlarme. Elijo entregarte a Ti el liderazgo de mi vida. Esp√≠ritu Santo, gu√≠a mi vida hoy, controla mis reacciones y dame poder para no ceder a mis peores impulsos. Am√©n."}, "fr": {"h2": "La Bataille Interne: L''Ego' vs. L'Esprit", "versiculos": "Galates 5:16-17 (NVT adapt√©): Je dis donc: Laissez l'Esprit guider votre vie. Ainsi, vous ne satisferez pas les d√©sirs de votre nature humaine. La nature humaine d√©sire faire exactement le contraire de ce que veut l'Esprit...", "resumo": "Ta vie est comme un champ de bataille interne: ta 'nature humaine' (l''Ego' ou la 'Chair') veut t'amener √† faire des choses qui semblent *bonnes sur le moment*, mais qui te d√©truisent (col√®re, envie, comm√©rages). Le Saint-Esprit veut te guider vers ce qui est juste. C'est √ßa la guerre. Le secret est: laisse l'Esprit guider ‚Äî donne-Lui le contr√¥le de ton fil d'actualit√©, de tes attitudes et de ton temps.", "aplicacao": "As-tu √©t√© 'entra√Æn√©' par tes √©motions et tes impulsions? L'Esprit est ton Meilleur Conseiller. Avant de r√©agir avec col√®re, avant de comm√©rer ou de te plaindre, fais une pause et demande: 'Que ferait l'Esprit ici?' Pratique cela, et tu gagneras la bataille.", "oracao": "Dieu, je confesse: ma nature humaine essaie de me contr√¥ler. Je choisis de Te confier le leadership de ma vie. Saint-Esprit, guide ma vie aujourd'hui, contr√¥le mes r√©actions et donne-moi la force de ne pas c√©der √† mes pires impulsions. Amen!"}},
  "7": {"pt": {"h2": "O Fruto: O 'Vibe' Que o Esp√≠rito Produz", "versiculos": "G√°latas 5:22-25 (NVT): Mas o Esp√≠rito produz este fruto: amor, alegria, paz, paci√™ncia, amabilidade, bondade, fidelidade, mansid√£o e dom√≠nio pr√≥prio. N√£o h√° lei contra essas coisas! (...) Que o Esp√≠rito, que nos deu vida, controle tamb√©m nossa vida!", "resumo": "O Fruto do Esp√≠rito n√£o √© uma lista de tarefas. √â a 'vibe' (o car√°ter, o jeito) de Jesus que o Esp√≠rito Santo produz naturalmente em voc√™ quando Ele est√° no controle. √â como um combo de 9 superpoderes! Se voc√™ est√° no Esp√≠rito (vers√≠culo 25), essas qualidades (amor, paz, dom√≠nio pr√≥prio) s√£o o resultado, e n√£o o esfor√ßo que voc√™ faz para tentar ser 'melhor'.", "aplicacao": "Seu 'mood' (humor, atitude) tem sido de raiva, impaci√™ncia ou de paz e bondade? N√£o tente *for√ßar* o fruto. Foque em andar no Esp√≠rito (deixar Ele no controle). Quanto mais voc√™ se conecta com Ele, mais o Seu fruto aparecer√°. Queira que a 'vibe' de Jesus seja a sua marca.", "oracao": "Esp√≠rito Santo, eu quero que a Sua 'vibe' seja a minha. Produza em mim mais amor e dom√≠nio pr√≥prio. Eu entrego o controle para que o Seu Fruto seja a prova de que Voc√™ est√° dirigindo a minha vida. Am√©m!"}, "en": {"h2": "The Fruit: The 'Vibe' the Spirit Produces", "versiculos": "Galatians 5:22-25 (NVT): But the Spirit produces this fruit: love, joy, peace, patience, kindness, goodness, faithfulness, gentleness, and self-control. There is no law against such things! (...) May the Spirit, who gave us life, control our lives also!", "resumo": "The Fruit of the Spirit is not a to-do list. It‚Äôs the 'vibe' (the character, the way) of Jesus that the Holy Spirit naturally produces in you when He is in control. It's like a combo of 9 superpowers! If you are in the Spirit (verse 25), these qualities (love, peace, self-control) are the result, not the effort you make to try to be 'better.'", "aplicacao": "Has your 'mood' (attitude) been one of anger, impatience, or one of peace and kindness? Don't try to *force* the fruit. Focus on walking in the Spirit (letting Him control). The more you connect with Him, the more His fruit will show. Want the 'Jesus vibe' to be your trademark.", "oracao": "Holy Spirit, I want Your 'vibe' to be mine. Produce in me more love and self-control. I hand over control so that Your Fruit is the proof that You are driving my life. Amen!"}, "es": {"h2": "El Fruto: La 'Vibe' Que el Esp√≠ritu Produce", "versiculos": "G√°latas 5:22-25 (NVT): Pero el Esp√≠ritu produce este fruto: amor, alegr√≠a, paz, paciencia, amabilidad, bondad, fidelidad, mansedumbre y dominio propio. ¬°No existe ninguna ley contra tales cosas! (...) ¬°Que el Esp√≠ritu, que nos dio vida, controle tambi√©n nuestra vida!", "resumo": "El Fruto del Esp√≠ritu no es una lista de tareas. Es la 'vibe' (el car√°cter, la forma de ser) de Jes√∫s que el Esp√≠ritu Santo produce naturalmente en ti cuando √âl est√° en control. ¬°Es como un combo de 9 superpoderes! Si est√°s en el Esp√≠ritu (vers√≠culo 25), estas cualidades (amor, paz, dominio propio) son el resultado, y no el esfuerzo que haces para intentar ser 'mejor'.", "aplicacao": "¬øTu 'mood' (estado de √°nimo, actitud) ha sido de ira, impaciencia o de paz y bondad? No intentes *forzar* el fruto. Conc√©ntrate en caminar en el Esp√≠ritu (dejarle el control). Cuanto m√°s te conectas con √âl, m√°s se manifestar√° Su fruto. Desea que la 'vibe' de Jes√∫s sea tu marca.", "oracao": "Esp√≠ritu Santo, quiero que Tu 'vibe' sea la m√≠a. Produce en m√≠ m√°s amor y dominio propio. Entrego el control para que Tu Fruto sea la prueba de que T√∫ est√°s dirigiendo mi vida. Am√©n."}, "fr": {"h2": "Le Fruit: La 'Vibe' Que l'Esprit Produit", "versiculos": "Galates 5:22-25 (NVT adapt√©): Mais l'Esprit produit ce fruit: amour, joie, paix, patience, bont√©, bienveillance, fid√©lit√©, douceur et ma√Ætrise de soi. Il n'y a pas de loi contre ces choses! (...) Que l'Esprit, qui nous a donn√© la vie, contr√¥le aussi notre vie!", "resumo": "Le Fruit de l'Esprit n'est pas une liste de t√¢ches. C'est la 'vibe' (le caract√®re, la mani√®re d'√™tre) de J√©sus que le Saint-Esprit produit naturellement en toi lorsqu'Il est aux commandes. C'est comme un combo de 9 super-pouvoirs! Si tu marches dans l'Esprit (verset 25), ces qualit√©s (amour, paix, ma√Ætrise de soi) sont le r√©sultat, et non l'effort que tu fais pour essayer d'√™tre 'meilleur'.", "aplicacao": "Ton 'mood' (humeur, attitude) a-t-il √©t√© de col√®re, d'impatience, ou de paix et de bont√©? N'essaie pas de *forcer* le fruit. Concentre-toi sur marcher dans l'Esprit (le laisser contr√¥ler). Plus tu te connectes √† Lui, plus Son fruit appara√Ætra. Veux que la 'vibe' de J√©sus soit ta marque de fabrique.", "oracao": "Saint-Esprit, je veux que Ta 'vibe' soit la mienne. Produis en moi plus d'amour et de ma√Ætrise de soi. Je Te donne le contr√¥le pour que Ton Fruit soit la preuve que Tu diriges ma vie. Amen!"}}


 };

        // FIM DO CONTE√öDO DEVOCIONAL

        // * FUN√á√ïES DE PERSIST√äNCIA E ESTADO (MANTIDAS) *
        
        function getSavedProgress() {
            const savedDay = localStorage.getItem(`devotionalProgress_${DEVOTIONAL_KEY}`);
            return savedDay ? parseInt(savedDay, 10) : 1;
        }

        function getCompletedDays() {
            const completed = localStorage.getItem(`completedDays_${DEVOTIONAL_KEY}`);
            return completed ? JSON.parse(completed) : {};
        }

        function saveCompletion(day, isChecked) {
            const key = `completedDays_${DEVOTIONAL_KEY}`;
            const completedDays = getCompletedDays();
            completedDays[day] = isChecked;
            localStorage.setItem(key, JSON.stringify(completedDays));
            updateOverallProgress();
        }

        function updateCompletedState() {
            const completedDaysMap = getCompletedDays();
            completedCheck.checked = completedDaysMap[currentDay] || false;
        }

        function updateOverallProgress() {
            const completedDaysMap = getCompletedDays();
            const completedCount = Object.values(completedDaysMap).filter(v => v).length;
            const percent = (completedCount / totalDays) * 100;
            progressBar.style.width = `${percent}%`;
            prevButton.disabled = currentDay <= 1;
            nextButton.disabled = currentDay >= totalDays;
            
            updateCompletedState();
        }

        // * EXECU√á√ÉO PRINCIPAL (INICIALIZA√á√ÉO) *
       window.onload = () => {
    
    // ‚úÖ CORRE√á√ÉO: Cancela imediatamente qualquer leitura que possa ter continuado
    stopSpeaking(); 
    
    // üö® LIMPEZA FOR√áADA DAS CHAVES ANTIGAS (MANTIDA)
    localStorage.removeItem('completedDays'); 
    localStorage.removeItem('devotionalProgress');
    
    // 1. Carrega o tema, idioma e FONTE
    loadThemePreference(); 
    // NOTE: updateLanguageSelector() is technically unnecessary since the dropdown is hidden, but kept for script integrity
    updateLanguageSelector();
    // NOVO: Aplica o tamanho da fonte salvo
    updateFontSize(); 
               
    // 2. Carrega o dia salvo e atualiza a UI
    currentDay = getSavedProgress();
    updateTexts(0); 
    
    // 3. Configura o TTS (CORRE√á√ÉO CR√çTICA)
    initTTS(); 

    // 4. Configura os Listeners de Eventos
    // NOTE: The event listeners for themeToggle and langSelectButton are now irrelevant as they are hidden, but kept for script integrity
    if (themeToggle) themeToggle.addEventListener('click', toggleDarkMode);
    
    if (listenToggle) {
        listenToggle.addEventListener('click', handleListenClick); 
        // üõë Duplo Clique para STOP expl√≠cito
        listenToggle.addEventListener('dblclick', stopSpeaking);
    }
    
    // Listeners do Seletor de Idioma
    if (langSelectButton) {
        langSelectButton.addEventListener('click', (event) => {
            event.stopPropagation();
            const isExpanded = langDropdown.style.display === 'block';
            langDropdown.style.display = isExpanded ? 'none' : 'block';
            // NOVO ARIA: Atualiza o status de expans√£o
            langSelectButton.setAttribute('aria-expanded', !isExpanded); 
        });
    }
    document.addEventListener('click', (event) => {
        const wrapper = document.querySelector('.language-selector-wrapper');
        if (langDropdown && langDropdown.style.display === 'block' && wrapper && !wrapper.contains(event.target)) {
            langDropdown.style.display = 'none';
            // NOVO ARIA: Garante que o status volte a false ao fechar
            if (langSelectButton) langSelectButton.setAttribute('aria-expanded', 'false'); 
        }
    });

    prevButton.addEventListener('click', prevDay);
    nextButton.addEventListener('click', nextDay);
    completedCheck.addEventListener('change', handleCompletedCheck);
    
    // NOVO: Listeners para o controle de fonte
    document.getElementById('fontSizeIncrease').addEventListener('click', increaseFontSize);
    document.getElementById('fontSizeDecrease').addEventListener('click', decreaseFontSize);
};
        
    </script>
    
    <div vw class="enabled">
        <div vw-access-button class="active"></div>
        <div vw-plugin-wrapper>
            <div class="vw-plugin-top-wrapper"></div>
        </div>
    </div>
    <script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
    <script>
        new window.VLibras.Widget('https://vlibras.gov.br/app', 'vw-plugin-wrapper');
    </script>
</body>
</html>